(this["webpackJsonpfriday-fellows-web"]=this["webpackJsonpfriday-fellows-web"]||[]).push([[0],{115:function(e,a,t){e.exports=t(149)},120:function(e,a,t){},122:function(e,a,t){},140:function(e,a,t){},145:function(e,a,t){},147:function(e,a,t){},148:function(e,a,t){},149:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),s=t(10),c=t.n(s),i=(t(120),t(23)),l=t.n(i),o=t(28),m=(t(122),t(15));function d(e){return function(a){return{payload:a,type:e}}}function u(e){return function(){return{type:e}}}var g,p="ACTION_FETCH_SEASONS_START",E="ACTION_FETCH_SEASONS_SUCCESS",f="ACTION_FETCH_SERIES_START",h="ACTION_FETCH_SERIES_SUCCESS",S="ACTION_FETCH_ONDECK_START",b="ACTION_FETCH_ONDECK_SUCCESS",v="ACTION_SET_SEASON_START_DATE",N="SET_SERIES_ID",O={fetchSeasonsStart:u(p),fetchSeasonsSuccess:d(E),fetchSeriesStart:u(f),fetchSeriesSuccess:d(h),fetchOnDeckStart:u(S),fetchOnDeckSuccess:d(b),setSeasonStartDate:d(v),setSeriesId:d(N)};!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SPRING=1]="SPRING",e[e.SUMMER=2]="SUMMER",e[e.FALL=3]="FALL",e[e.WINTER=4]="WINTER"}(g||(g={}));var y={ondeck:void 0,loadingOnDeck:!1,seasons:[],loadingSeasons:!1,seriesForSeason:[],loadingSeries:!1,lastSync:void 0};function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case p:return Object(m.a)({},e,{loadingSeasons:!0});case E:return Object(m.a)({},e,{seasons:a.payload.json,lastSync:a.payload.lastSync,loadingSeasons:!1});case f:return Object(m.a)({},e,{loadingSeries:!0});case h:return Object(m.a)({},e,{seriesForSeason:a.payload.json,loadingSeries:!1});case S:return Object(m.a)({},e,{loadingOnDeck:!0});case b:return Object(m.a)({},e,{ondeck:a.payload.report,loadingOnDeck:!1});case v:var t=e.seasons.indexOf(a.payload.season);return Object(m.a)({},e,{seasons:e.seasons.map((function(e,n){if(n!==t)return e;var r=a.payload.startDate;return Object(m.a)({},e,{startDate:r?r.getTime():null})}))});case N:var n=e.seriesForSeason.indexOf(a.payload.series);return Object(m.a)({},e,{seriesForSeason:e.seriesForSeason.map((function(e,t){return t!==n?e:Object(m.a)({},e,{},a.payload.data)}))});default:return e}}var k=t(40),C=t.n(k),x=t(36),I=(t(140),t(184)),j=t(213),D=t(187),L=t(64),R=t(214),A=t(191),T=t(189),_=t(25),U=Object(I.a)((function(e){return Object(j.a)({header:Object(m.a)({},e.typography.button,{padding:e.spacing(1),marginLeft:"auto",marginRight:"auto",marginBottom:e.spacing(2),width:"fit-content",display:"flex",alignItems:"center"}),title:{marginLeft:e.spacing(1),marginRight:e.spacing(2)},lastSync:{marginRight:e.spacing(3)},root:{overflowX:"auto",margin:"0 10px"},table:{padding:"15px",minWidth:650,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridGap:e.spacing(3)},gridCell:{minWidth:"150px",minHeight:"150px",textAlign:"center",color:e.palette.text.secondary,whiteSpace:"nowrap"},cellLink:{textDecoration:"none"},cellBtn:{height:"150px"},cellTitle:{height:"40%",verticalAlign:"middle",lineHeight:"70px",fontSize:"30px"},cellDetails:{height:"50%",display:"grid",gridTemplateRows:"repeat(2, 1fr)",gridTemplateColumns:"repeat(2, 1fr)",margin:"10px"},unknownLabel:{fontSize:"15px",backgroundColor:"#525252",color:"#e29e00",margin:"auto",padding:"10px",borderRadius:"40px"},droppedLabel:{fontSize:"15px",backgroundColor:"#525252",color:"#e83f22",margin:"auto",padding:"10px",borderRadius:"40px"},watchingLabel:{fontSize:"15px",backgroundColor:"#525252",color:"#42af42",margin:"auto",padding:"10px",borderRadius:"40px"},completedLabel:{fontSize:"15px",backgroundColor:"#525252",color:"#4e92f9",margin:"auto",padding:"10px",borderRadius:"40px"}})}));var F,W=function(e){var a=e.seasons,t=e.lastSyncDate,n=e.loading,s=U(),c=function(e){var a=e.season;return r.a.createElement(_.b,{to:"/s/"+a.sheetId,className:s.cellLink},r.a.createElement(D.a,{className:s.gridCell},r.a.createElement(T.a,{className:s.cellBtn},r.a.createElement("div",{className:s.cellTitle},a.formattedName),r.a.createElement("div",{className:s.cellDetails},a.seriesStats[0]>0&&r.a.createElement("div",{className:s.unknownLabel},"Unknown ",a.seriesStats[0]),a.seriesStats[1]>0&&r.a.createElement("div",{className:s.droppedLabel},"Dropped ",a.seriesStats[1]),a.seriesStats[2]>0&&r.a.createElement("div",{className:s.watchingLabel},"Watching ",a.seriesStats[2]),a.seriesStats[3]>0&&r.a.createElement("div",{className:s.completedLabel},"Completed ",a.seriesStats[3])))))};return r.a.createElement("div",null,r.a.createElement(L.a,{className:s.header},r.a.createElement("span",{className:s.title},"All Seasons"),r.a.createElement(R.a,{title:"Last time data was read from GoogleSheets"},r.a.createElement("span",{className:s.lastSync},"Last Sync:\xa0",function(e){return e?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}).format(e):"Unknown"}(t)))),r.a.createElement(L.a,{className:s.root},!n&&r.a.createElement("div",{className:s.table,"aria-label":"seasons grid"},a.map((function(e){return r.a.createElement(c,{season:e})}))),n&&r.a.createElement(A.a,{size:60})))},B=(t(145),t(16)),z=t(211),H=t(96),M=t(212),K=t(192),G=t(193),P=t(210),V=t(195),J=t(196),X=t(199),$=t(201),q=t(202),Q=t(203),Y=t(204),Z=t(205),ee=t(200),ae=t(197),te=t(91),ne=t.n(te);!function(e){e[e.Unknown=0]="Unknown",e[e.Dropped=1]="Dropped",e[e.Watching=2]="Watching",e[e.Completed=3]="Completed",e[e.Continuing=4]="Continuing"}(F||(F={}));var re=Object(I.a)((function(e){return Object(j.a)({header:Object(m.a)({},e.typography.button,{padding:e.spacing(1),marginLeft:"auto",marginRight:"auto",marginBottom:e.spacing(2),width:"fit-content",display:"flex",alignItems:"center"}),title:{marginLeft:e.spacing(1),marginRight:e.spacing(2),fontSize:"20px"},datePicker:{margin:0},pushLeft:{marginLeft:"10px"},paperBody:{margin:"auto",maxWidth:"60vw"},root:{overflowX:"auto",margin:"0 10px"},table:{minWidth:650}})}));function se(e){var a=e.onClose,t=e.open,s=e.series,c=Object(n.useState)(s&&s.idAL||0),i=Object(o.a)(c,2),l=i[0],m=i[1],d=function(){a(l)};Object(n.useEffect)((function(){t&&m(s&&s.idAL||0)}),[t,s]);return r.a.createElement(M.a,{open:t,onClose:d,"aria-labelledby":"set-id-dialog-title","aria-describedby":"set-id-dialog-description"},r.a.createElement(K.a,{id:"set-id-dialog-title"},"Set AniList.co Id for Series"),r.a.createElement(G.a,null,r.a.createElement(P.a,{id:"id-input",label:"AniList Id",type:"number",variant:"outlined",InputLabelProps:{shrink:!0},margin:"normal",value:l,onChange:function(e){m(parseInt(e.target.value))}})),r.a.createElement(V.a,null,r.a.createElement(J.a,{onClick:d,color:"primary"},"Confirm")))}function ce(e){for(var a=e.seriesList,t=re(),n=a.reduce((function(e,a){var t=a.votingRecord[a.votingRecord.length-1].weekNum;return t>e?t:e}),0),s=[],c=1;c<=n;c++)s.push(r.a.createElement($.a,{key:c,align:"right"},"Week ",c));return r.a.createElement(L.a,{className:t.root},r.a.createElement(q.a,{className:t.table,"aria-label":"series voting grid"},r.a.createElement(Q.a,null,r.a.createElement(Y.a,null,r.a.createElement($.a,null,"Series Name"),r.a.createElement($.a,null,"Status"),s)),r.a.createElement(Z.a,null,a.map((function(e){return r.a.createElement(Y.a,{key:e.rowIndex},r.a.createElement($.a,{component:"th",scope:"row"},e.title.raw,-1!==e.idAL&&r.a.createElement(ae.a,{className:t.pushLeft,href:"https://anilist.co/anime/".concat(e.idAL),target:"_blank"},r.a.createElement(ne.a,{fontSize:"small"}))),r.a.createElement($.a,null,F[e.votingStatus]),e.votingRecord.map((function(e){return r.a.createElement($.a,{align:"right"},e.msg?e.msg:["Ep",e.episodeNum,":",e.votesFor,"-",e.votesAgainst].join(" "))})))})))))}function ie(e){var a=e.seriesList,t=e.openIDDialog,n=re(),s=function(e){var a=e.onClick,t=e.series;return r.a.createElement(J.a,{onClick:function(){a(t)}},"Edit")};return r.a.createElement(L.a,{className:n.root},r.a.createElement(q.a,{className:n.table,"aria-label":"series debug grid"},r.a.createElement(Q.a,null,r.a.createElement(Y.a,null,r.a.createElement($.a,null,"Series Name\xa0(Raw)"),r.a.createElement($.a,null,"Series Name\xa0(AniList)"),r.a.createElement($.a,{align:"right"},"AniList\xa0ID"),r.a.createElement($.a,{align:"right"},"MAL\xa0ID"),r.a.createElement($.a,{align:"right"},"Type"),r.a.createElement($.a,{align:"right"},"Episodes"))),r.a.createElement(Z.a,null,a.map((function(e){return r.a.createElement(Y.a,{key:e.rowIndex},r.a.createElement($.a,{component:"th",scope:"row"},e.title.raw),r.a.createElement($.a,null,e.title.english),r.a.createElement($.a,{align:"right"},e.idAL),r.a.createElement($.a,{align:"right"},e.idMal),r.a.createElement($.a,{align:"right"},e.type),r.a.createElement($.a,{align:"right"},e.episodes),r.a.createElement($.a,null,r.a.createElement(s,{onClick:t,series:e})))})))))}var le=function(e){var a=e.dispatch,t=e.backendURI,s=e.season,c=e.seriesList,i=void 0===c?[]:c,m=e.onStartDateChanged,d=e.onSeriesIdChanged,u=Object(x.g)().seasonId,g=Object(n.useState)(!1),p=Object(o.a)(g,2),E=p[0],f=p[1],h=Object(n.useState)(null),S=Object(o.a)(h,2),b=S[0],v=S[1],N=Object(n.useState)(!1),y=Object(o.a)(N,2),w=y[0],k=y[1],I=re();if(Object(n.useEffect)((function(){!function(){var e;l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a(O.fetchSeriesStart()),n.next=4,l.a.awrap(C.a.get(t+"/getSeries?seasonId="+u));case 4:e=n.sent,a(O.fetchSeriesSuccess({json:e.data.series})),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0);case 11:case"end":return n.stop()}}),null,null,[[0,8]])}()}),[a,t,u]),!s)return null;return r.a.createElement("div",null,r.a.createElement(L.a,{className:I.header},r.a.createElement("span",{className:I.title},s.formattedName),r.a.createElement(B.a,{utils:H.a},r.a.createElement(z.a,{className:I.datePicker,label:"Start Date",disableToolbar:!0,inputVariant:"outlined",variant:"inline",format:"MM/dd/yyyy",autoOk:!0,value:s.startDate,onChange:function(e){m(e,s)},KeyboardButtonProps:{"aria-label":"change date"},margin:"dense"})),null===s.startDate&&r.a.createElement(R.a,{title:"Missing Start Date"},r.a.createElement(X.a,{className:"push-left warning-icon text-top"},"warning")),r.a.createElement(ee.a,{value:"debug",selected:w,onChange:function(){k(!w)}},"Debug")),w&&r.a.createElement(ie,{seriesList:i,openIDDialog:function(e){v(e),f(!0)}}),!w&&r.a.createElement(ce,{seriesList:i}),r.a.createElement(se,{open:E,onClose:function(e){f(!1),b&&b.idAL!==e&&d(b,s.sheetId,e),v(null)},series:b}))},oe=t(92),me=t.n(oe),de=(t(147),t(206)),ue=t(198),ge=t(100),pe=t(215),Ee=Object(I.a)((function(e){return Object(j.a)({logo:{marginRight:e.spacing(2)},title:{marginRight:e.spacing(3)},navButton:{marginRight:e.spacing(1)},grow:{flexGrow:1}})})),fe=function(){var e=Ee();return r.a.createElement("div",null,r.a.createElement(de.a,{position:"static"},r.a.createElement(ue.a,null,r.a.createElement(ae.a,{edge:"start",className:e.logo,color:"inherit","aria-label":"logo"},r.a.createElement(_.b,{to:"/"},r.a.createElement("img",{src:me.a,className:"App-logo",alt:"logo"}))),r.a.createElement(ge.a,{variant:"h6",className:e.title},"Friday Fellows Updater"),r.a.createElement(pe.a,{disableRipple:!0,component:_.c,to:"/ondeck",activeClassName:"activeLink"},r.a.createElement(J.a,{variant:"contained",className:e.navButton},"On Deck")),r.a.createElement(pe.a,{disableRipple:!0,component:_.c,to:"/seasons",activeClassName:"activeLink"},r.a.createElement(J.a,{variant:"contained",className:e.navButton},"Seasons")),r.a.createElement(pe.a,{disableRipple:!0,component:_.c,to:"/admin",activeClassName:"activeLink"},r.a.createElement(J.a,{variant:"contained",className:e.navButton,disabled:!0},"Admin")),r.a.createElement("div",{className:e.grow}),r.a.createElement(J.a,{color:"inherit"},"Login"))))},he=t(98),Se=t(3),be=t(93),ve=t.n(be),Ne=t(95),Oe=t.n(Ne),ye=t(207),we=t(216),ke=t(208),Ce=t(94),xe=t.n(Ce),Ie={success:ve.a,error:xe.a},je=Object(I.a)((function(e){return{success:{backgroundColor:ye.a[600]},error:{backgroundColor:e.palette.error.dark},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}}));function De(e){var a=je({}),t=e.className,n=e.message,s=e.onClose,c=e.variant,i=Object(he.a)(e,["className","message","onClose","variant"]),l=Ie[c];return r.a.createElement(ke.a,Object.assign({className:Object(Se.a)(a[c],t),"aria-describedby":"client-snackbar",message:r.a.createElement("span",{id:"client-snackbar",className:a.message},r.a.createElement(l,{className:Object(Se.a)(a.icon,a.iconVariant)}),n),action:[r.a.createElement(ae.a,{key:"close","aria-label":"close",color:"inherit",onClick:s},r.a.createElement(Oe.a,{className:a.icon}))]},i))}function Le(e){var a=e.open,t=e.msg,n=e.handleClose;function s(e,a){"clickaway"!==a&&n(!1)}return r.a.createElement(we.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a,autoHideDuration:6e3,onClose:s},r.a.createElement(De,{onClose:s,variant:"error",message:t}))}function Re(e){var a=e.open,t=e.msg,n=e.handleClose;function s(e,a){"clickaway"!==a&&n(!1)}return r.a.createElement(we.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a,autoHideDuration:3e3,onClose:s},r.a.createElement(De,{onClose:s,variant:"success",message:t}))}t(148);var Ae=Object(I.a)((function(e){return Object(j.a)({header:Object(m.a)({},e.typography.button,{padding:e.spacing(1),marginLeft:"auto",marginRight:"auto",marginBottom:e.spacing(2),width:"fit-content"}),headerSegment:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},paperBody:{margin:"auto",maxWidth:"60vw"},table:{minWidth:650}})})),Te=function(e){var a,t=e.report,n=e.loading,s=void 0!==n&&n,c=Ae();return r.a.createElement("div",null,r.a.createElement(L.a,{className:c.header},r.a.createElement("span",{className:c.headerSegment},null===t||void 0===t?void 0:t.seasonName),r.a.createElement("span",{className:c.headerSegment},"Week ",null===t||void 0===t?void 0:t.week),r.a.createElement("span",{className:c.headerSegment},"Next Session: ",(a=null===t||void 0===t?void 0:t.targetWatchDate)?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"2-digit"}).format(new Date(a)):"Unknown")),r.a.createElement(L.a,{className:c.paperBody},r.a.createElement(q.a,{className:c.table,"aria-label":"simple table"},r.a.createElement(Q.a,null,r.a.createElement(Y.a,null,r.a.createElement($.a,null,"Series Title (English)"),r.a.createElement($.a,{align:"right"},"Episode"))),!s&&t&&r.a.createElement(Z.a,null,t.series.map((function(e){return r.a.createElement(Y.a,{key:e.title.raw},r.a.createElement($.a,{component:"th",scope:"row"},e.title.raw),r.a.createElement($.a,{align:"right"},e.episode))})))),s&&r.a.createElement(A.a,{size:60})))},_e=function(e){var a=e.backendURI,t=Object(n.useReducer)(w,y),s=Object(o.a)(t,2),c=s[0],i=s[1],m=Object(n.useState)(!1),d=Object(o.a)(m,2),u=d[0],g=d[1],p=Object(n.useState)(""),E=Object(o.a)(p,2),f=E[0],h=E[1],S=Object(n.useState)(!1),b=Object(o.a)(S,2),v=b[0],N=b[1],k=Object(n.useState)(""),I=Object(o.a)(k,2),j=I[0],D=I[1];Object(n.useEffect)((function(){!function(){var e,t,n;l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,i(O.fetchSeasonsStart()),r.next=4,l.a.awrap(C.a.get(a+"/getAllSeasons"));case 4:e=r.sent,t=e.data.lastSyncMs,n=t?new Date(t):void 0,i(O.fetchSeasonsSuccess({json:e.data.seasons,lastSync:n})),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),console.log(r.t0);case 13:case"end":return r.stop()}}),null,null,[[0,10]])}()}),[a]),Object(n.useEffect)((function(){!function(){var e,t;l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i(O.fetchOnDeckStart()),n.next=4,l.a.awrap(C.a.get(a+"/getOnDeckReports"));case 4:e=n.sent,(t=e.data.reports)&&t.length>0&&i(O.fetchOnDeckSuccess({report:t[0]})),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0);case 12:case"end":return n.stop()}}),null,null,[[0,9]])}()}),[a]);var L=function(e,t){var n;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n={sheetId:t.sheetId,startDate:e?e.getTime():null},r.next=3,l.a.awrap(C.a.post(a+"/setSeasonStartDate",n));case 3:200===r.sent.status&&i(O.setSeasonStartDate({season:t,startDate:e}));case 5:case"end":return r.stop()}}))},R=function(e,t,n){var r,s;return l.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return r={seasonId:t,row:e.rowIndex,seriesId:n},c.prev=1,c.next=4,l.a.awrap(C.a.post(a+"/setSeriesId",r));case 4:200===(s=c.sent).status&&(i(O.setSeriesId({series:e,data:s.data.data})),h("Updated AniList ID for ".concat(e.title.raw)),g(!0)),c.next=12;break;case 8:c.prev=8,c.t0=c.catch(1),D("Error when updating AniList ID for ".concat(e.title.raw)),N(!0);case 12:case"end":return c.stop()}}),null,null,[[1,8]])};return r.a.createElement("div",{className:"App"},r.a.createElement(fe,null),r.a.createElement("div",{className:"App-body"},r.a.createElement(x.d,null,r.a.createElement(x.b,{exact:!0,path:"/"},r.a.createElement(x.a,{to:"/ondeck"})),r.a.createElement(x.b,{exact:!0,path:"/ondeck"},r.a.createElement(Te,{report:c.ondeck,loading:c.loadingOnDeck})),r.a.createElement(x.b,{exact:!0,path:"/seasons"},r.a.createElement(W,{seasons:c.seasons,lastSyncDate:c.lastSync,loading:c.loadingSeasons,onStartDateChanged:L})),r.a.createElement(x.b,{path:"/s/:seasonId",render:function(e){var t=e.match;return r.a.createElement(le,{dispatch:i,backendURI:a,season:c.seasons.find((function(e){return String(e.sheetId)===t.params.seasonId})),seriesList:c.seriesForSeason,onStartDateChanged:L,onSeriesIdChanged:R})}}))),r.a.createElement((function(){return r.a.createElement("div",{className:"App-footer"},r.a.createElement("a",{href:"https://github.com/brisberg/friday-fellows-gcf"},"Github"))}),null),r.a.createElement(Re,{open:u,msg:f,handleClose:g}),r.a.createElement(Le,{open:v,msg:j,handleClose:N}))};var Ue={BACKEND_URI:"https://us-central1-driven-utility-202807.cloudfunctions.net"};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Fe=t(209),We=t(97),Be=Object(We.a)({palette:{type:"dark"}});c.a.render(r.a.createElement(Fe.a,{theme:Be},r.a.createElement(_.a,null,r.a.createElement(_e,{backendURI:Ue.BACKEND_URI}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},92:function(e,a,t){e.exports=t.p+"static/media/logo.25bf045c.svg"}},[[115,1,2]]]);
//# sourceMappingURL=main.30f77b93.chunk.js.map
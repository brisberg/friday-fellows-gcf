(this["webpackJsonpfriday-fellows-web"]=this["webpackJsonpfriday-fellows-web"]||[]).push([[0],{114:function(e,a,t){e.exports=t(148)},119:function(e,a,t){},121:function(e,a,t){},139:function(e,a,t){},144:function(e,a,t){},145:function(e,a,t){},147:function(e,a,t){},148:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),s=t(10),c=t.n(s),i=(t(119),t(23)),l=t.n(i),o=t(28),m=(t(121),t(15));function d(e){return function(a){return{payload:a,type:e}}}function u(e){return function(){return{type:e}}}var g,p="ACTION_FETCH_SEASONS_START",E="ACTION_FETCH_SEASONS_SUCCESS",f="ACTION_FETCH_SERIES_START",h="ACTION_FETCH_SERIES_SUCCESS",S="ACTION_FETCH_ONDECK_START",b="ACTION_FETCH_ONDECK_SUCCESS",v="ACTION_SET_SEASON_START_DATE",N="SET_SERIES_ID",O={fetchSeasonsStart:u(p),fetchSeasonsSuccess:d(E),fetchSeriesStart:u(f),fetchSeriesSuccess:d(h),fetchOnDeckStart:u(S),fetchOnDeckSuccess:d(b),setSeasonStartDate:d(v),setSeriesId:d(N)};!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SPRING=1]="SPRING",e[e.SUMMER=2]="SUMMER",e[e.FALL=3]="FALL",e[e.WINTER=4]="WINTER"}(g||(g={}));var y={ondeck:void 0,loadingOnDeck:!1,seasons:[],loadingSeasons:!1,seriesForSeason:[],loadingSeries:!1,lastSync:void 0};function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case p:return Object(m.a)({},e,{loadingSeasons:!0});case E:return Object(m.a)({},e,{seasons:a.payload.json,lastSync:a.payload.lastSync,loadingSeasons:!1});case f:return Object(m.a)({},e,{loadingSeries:!0});case h:return Object(m.a)({},e,{seriesForSeason:a.payload.json,loadingSeries:!1});case S:return Object(m.a)({},e,{loadingOnDeck:!0});case b:return Object(m.a)({},e,{ondeck:a.payload.report,loadingOnDeck:!1});case v:var t=e.seasons.indexOf(a.payload.season);return Object(m.a)({},e,{seasons:e.seasons.map((function(e,n){if(n!==t)return e;var r=a.payload.startDate;return Object(m.a)({},e,{startDate:r?r.getTime():null})}))});case N:var n=e.seriesForSeason.indexOf(a.payload.series);return Object(m.a)({},e,{seriesForSeason:e.seriesForSeason.map((function(e,t){return t!==n?e:Object(m.a)({},e,{},a.payload.data)}))});default:return e}}var C=t(40),w=t.n(C),x=t(36),j=(t(139),t(183)),I=t(212),D=t(186),R=t(63),L=t(213),A=t(190),T=t(188),_=t(25),U=Object(j.a)((function(e){return Object(I.a)({header:Object(m.a)({},e.typography.button,{padding:e.spacing(1),marginLeft:"auto",marginRight:"auto",marginBottom:e.spacing(2),width:"fit-content",display:"flex",alignItems:"center"}),title:{marginLeft:e.spacing(1),marginRight:e.spacing(2)},lastSync:{marginRight:e.spacing(3)},root:{overflowX:"auto",margin:"0 10px"},table:{padding:"15px",minWidth:650,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridGap:e.spacing(3)},gridCell:{minWidth:"150px",minHeight:"150px",textAlign:"center",color:e.palette.text.secondary,whiteSpace:"nowrap"},cellLink:{textDecoration:"none"},cellBtn:{height:"150px"},cellTitle:{height:"40%",verticalAlign:"middle",lineHeight:"70px",fontSize:"30px"},cellDetails:{height:"50%",display:"grid",gridTemplateRows:"repeat(2, 1fr)",gridTemplateColumns:"repeat(2, 1fr)",margin:"10px"},unknownLabel:{fontSize:"15px",backgroundColor:"#525252",color:"#e29e00",margin:"auto",padding:"10px",borderRadius:"40px"},droppedLabel:{fontSize:"15px",backgroundColor:"#525252",color:"#e83f22",margin:"auto",padding:"10px",borderRadius:"40px"},watchingLabel:{fontSize:"15px",backgroundColor:"#525252",color:"#42af42",margin:"auto",padding:"10px",borderRadius:"40px"},completedLabel:{fontSize:"15px",backgroundColor:"#525252",color:"#4e92f9",margin:"auto",padding:"10px",borderRadius:"40px"}})}));var F,B=function(e){var a=e.seasons,t=e.lastSyncDate,n=e.loading,s=U(),c=function(e){var a=e.season;return r.a.createElement(_.b,{to:"/s/"+a.sheetId,className:s.cellLink},r.a.createElement(D.a,{className:s.gridCell},r.a.createElement(T.a,{className:s.cellBtn},r.a.createElement("div",{className:s.cellTitle},a.formattedName),r.a.createElement("div",{className:s.cellDetails},a.seriesStats[0]>0&&r.a.createElement("div",{className:s.unknownLabel},"Unknown ",a.seriesStats[0]),a.seriesStats[1]>0&&r.a.createElement("div",{className:s.droppedLabel},"Dropped ",a.seriesStats[1]),a.seriesStats[2]>0&&r.a.createElement("div",{className:s.watchingLabel},"Watching ",a.seriesStats[2]),a.seriesStats[3]>0&&r.a.createElement("div",{className:s.completedLabel},"Completed ",a.seriesStats[3])))))};return r.a.createElement("div",null,r.a.createElement(R.a,{className:s.header},r.a.createElement("span",{className:s.title},"All Seasons"),r.a.createElement(L.a,{title:"Last time data was read from GoogleSheets"},r.a.createElement("span",{className:s.lastSync},"Last Sync:\xa0",function(e){return e?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"}).format(e):"Unknown"}(t)))),r.a.createElement(R.a,{className:s.root},!n&&r.a.createElement("div",{className:s.table,"aria-label":"seasons grid"},a.map((function(e){return r.a.createElement(c,{season:e})}))),n&&r.a.createElement(A.a,{size:60})))},W=(t(144),t(16)),z=t(210),H=t(95),M=t(211),K=t(191),G=t(192),P=t(209),V=t(194),J=t(195),X=t(198),$=t(200),q=t(201),Q=t(202),Y=t(203),Z=t(204),ee=t(199);!function(e){e[e.Unknown=0]="Unknown",e[e.Dropped=1]="Dropped",e[e.Watching=2]="Watching",e[e.Completed=3]="Completed",e[e.Continuing=4]="Continuing"}(F||(F={}));var ae=Object(j.a)((function(e){return Object(I.a)({header:Object(m.a)({},e.typography.button,{padding:e.spacing(1),marginLeft:"auto",marginRight:"auto",marginBottom:e.spacing(2),width:"fit-content",display:"flex",alignItems:"center"}),title:{marginLeft:e.spacing(1),marginRight:e.spacing(2),fontSize:"20px"},datePicker:{margin:0},paperBody:{margin:"auto",maxWidth:"60vw"},root:{overflowX:"auto",margin:"0 10px"},table:{minWidth:650}})}));function te(e){var a=e.onClose,t=e.open,s=e.series,c=Object(n.useState)(s&&s.idAL||0),i=Object(o.a)(c,2),l=i[0],m=i[1],d=function(){a(l)};Object(n.useEffect)((function(){t&&m(s&&s.idAL||0)}),[t,s]);return r.a.createElement(M.a,{open:t,onClose:d,"aria-labelledby":"set-id-dialog-title","aria-describedby":"set-id-dialog-description"},r.a.createElement(K.a,{id:"set-id-dialog-title"},"Set AniList.co Id for Series"),r.a.createElement(G.a,null,r.a.createElement(P.a,{id:"id-input",label:"AniList Id",type:"number",variant:"outlined",InputLabelProps:{shrink:!0},margin:"normal",value:l,onChange:function(e){m(parseInt(e.target.value))}})),r.a.createElement(V.a,null,r.a.createElement(J.a,{onClick:d,color:"primary"},"Confirm")))}function ne(e){for(var a=e.seriesList,t=ae(),n=a.reduce((function(e,a){var t=a.votingRecord[a.votingRecord.length-1].weekNum;return t>e?t:e}),0),s=[],c=1;c<=n;c++)s.push(r.a.createElement($.a,{key:c,align:"right"},"Week ",c));return r.a.createElement(R.a,{className:t.root},r.a.createElement(q.a,{className:t.table,"aria-label":"series voting grid"},r.a.createElement(Q.a,null,r.a.createElement(Y.a,null,r.a.createElement($.a,null,"Series Name"),r.a.createElement($.a,null,"Status"),s)),r.a.createElement(Z.a,null,a.map((function(e){return r.a.createElement(Y.a,{key:e.rowIndex},r.a.createElement($.a,{component:"th",scope:"row"},e.titleRaw),r.a.createElement($.a,null,F[e.votingStatus]),e.votingRecord.map((function(e){return r.a.createElement($.a,{align:"right"},e.msg?e.msg:["Ep",e.episodeNum,":",e.votesFor,"-",e.votesAgainst].join(" "))})))})))))}function re(e){var a=e.seriesList,t=e.openIDDialog,n=ae(),s=function(e){var a=e.onClick,t=e.series;return r.a.createElement(J.a,{onClick:function(){a(t)}},"Edit")};return r.a.createElement(R.a,{className:n.root},r.a.createElement(q.a,{className:n.table,"aria-label":"series debug grid"},r.a.createElement(Q.a,null,r.a.createElement(Y.a,null,r.a.createElement($.a,null,"Series Name\xa0(Raw)"),r.a.createElement($.a,null,"Series Name\xa0(AniList)"),r.a.createElement($.a,{align:"right"},"AniList\xa0ID"),r.a.createElement($.a,{align:"right"},"MAL\xa0ID"),r.a.createElement($.a,{align:"right"},"Type"),r.a.createElement($.a,{align:"right"},"Episodes"))),r.a.createElement(Z.a,null,a.map((function(e){return r.a.createElement(Y.a,{key:e.rowIndex},r.a.createElement($.a,{component:"th",scope:"row"},e.titleRaw),r.a.createElement($.a,null,e.titleEn),r.a.createElement($.a,{align:"right"},e.idAL),r.a.createElement($.a,{align:"right"},e.idMal),r.a.createElement($.a,{align:"right"},e.type),r.a.createElement($.a,{align:"right"},e.episodes),r.a.createElement($.a,null,r.a.createElement(s,{onClick:t,series:e})))})))))}var se=function(e){var a=e.dispatch,t=e.backendURI,s=e.season,c=e.seriesList,i=void 0===c?[]:c,m=e.onStartDateChanged,d=e.onSeriesIdChanged,u=Object(x.g)().seasonId,g=Object(n.useState)(!1),p=Object(o.a)(g,2),E=p[0],f=p[1],h=Object(n.useState)(null),S=Object(o.a)(h,2),b=S[0],v=S[1],N=Object(n.useState)(!1),y=Object(o.a)(N,2),k=y[0],C=y[1],j=ae();if(Object(n.useEffect)((function(){!function(){var e;l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,a(O.fetchSeriesStart()),n.next=4,l.a.awrap(w.a.get(t+"/getSeries?seasonId="+u));case 4:e=n.sent,a(O.fetchSeriesSuccess({json:e.data.series})),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0);case 11:case"end":return n.stop()}}),null,null,[[0,8]])}()}),[a,t,u]),!s)return null;return r.a.createElement("div",null,r.a.createElement(R.a,{className:j.header},r.a.createElement("span",{className:j.title},s.formattedName),r.a.createElement(W.a,{utils:H.a},r.a.createElement(z.a,{className:j.datePicker,label:"Start Date",disableToolbar:!0,inputVariant:"outlined",variant:"inline",format:"MM/dd/yyyy",autoOk:!0,value:s.startDate,onChange:function(e){m(e,s)},KeyboardButtonProps:{"aria-label":"change date"},margin:"dense"})),null===s.startDate&&r.a.createElement(L.a,{title:"Missing Start Date"},r.a.createElement(X.a,{className:"push-left warning-icon text-top"},"warning")),r.a.createElement(ee.a,{value:"debug",selected:k,onChange:function(){C(!k)}},"Debug")),k&&r.a.createElement(re,{seriesList:i,openIDDialog:function(e){v(e),f(!0)}}),!k&&r.a.createElement(ne,{seriesList:i}),r.a.createElement(te,{open:E,onClose:function(e){f(!1),b&&b.idAL!==e&&d(b,s.sheetId,e),v(null)},series:b}))},ce=t(91),ie=t.n(ce),le=(t(145),t(205)),oe=t(197),me=t(196),de=t(99),ue=t(214),ge=Object(j.a)((function(e){return Object(I.a)({logo:{marginRight:e.spacing(2)},title:{marginRight:e.spacing(3)},navButton:{marginRight:e.spacing(1)},grow:{flexGrow:1}})})),pe=function(){var e=ge();return r.a.createElement("div",null,r.a.createElement(le.a,{position:"static"},r.a.createElement(oe.a,null,r.a.createElement(me.a,{edge:"start",className:e.logo,color:"inherit","aria-label":"logo"},r.a.createElement(_.b,{to:"/"},r.a.createElement("img",{src:ie.a,className:"App-logo",alt:"logo"}))),r.a.createElement(de.a,{variant:"h6",className:e.title},"Friday Fellows Updater"),r.a.createElement(ue.a,{disableRipple:!0,component:_.c,to:"/ondeck",activeClassName:"activeLink"},r.a.createElement(J.a,{variant:"contained",className:e.navButton},"On Deck")),r.a.createElement(ue.a,{disableRipple:!0,component:_.c,to:"/seasons",activeClassName:"activeLink"},r.a.createElement(J.a,{variant:"contained",className:e.navButton},"Seasons")),r.a.createElement(ue.a,{disableRipple:!0,component:_.c,to:"/admin",activeClassName:"activeLink"},r.a.createElement(J.a,{variant:"contained",className:e.navButton,disabled:!0},"Admin")),r.a.createElement("div",{className:e.grow}),r.a.createElement(J.a,{color:"inherit"},"Login"))))},Ee=t(97),fe=t(3),he=t(92),Se=t.n(he),be=t(94),ve=t.n(be),Ne=t(206),Oe=t(215),ye=t(207),ke=t(93),Ce=t.n(ke),we={success:Se.a,error:Ce.a},xe=Object(j.a)((function(e){return{success:{backgroundColor:Ne.a[600]},error:{backgroundColor:e.palette.error.dark},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}}));function je(e){var a=xe({}),t=e.className,n=e.message,s=e.onClose,c=e.variant,i=Object(Ee.a)(e,["className","message","onClose","variant"]),l=we[c];return r.a.createElement(ye.a,Object.assign({className:Object(fe.a)(a[c],t),"aria-describedby":"client-snackbar",message:r.a.createElement("span",{id:"client-snackbar",className:a.message},r.a.createElement(l,{className:Object(fe.a)(a.icon,a.iconVariant)}),n),action:[r.a.createElement(me.a,{key:"close","aria-label":"close",color:"inherit",onClick:s},r.a.createElement(ve.a,{className:a.icon}))]},i))}function Ie(e){var a=e.open,t=e.msg,n=e.handleClose;function s(e,a){"clickaway"!==a&&n(!1)}return r.a.createElement(Oe.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a,autoHideDuration:6e3,onClose:s},r.a.createElement(je,{onClose:s,variant:"error",message:t}))}function De(e){var a=e.open,t=e.msg,n=e.handleClose;function s(e,a){"clickaway"!==a&&n(!1)}return r.a.createElement(Oe.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a,autoHideDuration:3e3,onClose:s},r.a.createElement(je,{onClose:s,variant:"success",message:t}))}t(147);var Re=Object(j.a)((function(e){return Object(I.a)({header:Object(m.a)({},e.typography.button,{padding:e.spacing(1),marginLeft:"auto",marginRight:"auto",marginBottom:e.spacing(2),width:"fit-content"}),headerSegment:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},paperBody:{margin:"auto",maxWidth:"60vw"},table:{minWidth:650}})})),Le=function(e){var a=e.report,t=e.loading,n=void 0!==t&&t,s=Re();return r.a.createElement("div",null,r.a.createElement(R.a,{className:s.header},r.a.createElement("span",{className:s.headerSegment},"Fall 2019"),r.a.createElement("span",{className:s.headerSegment},"Week 10"),r.a.createElement("span",{className:s.headerSegment},"Next Session: 11/22/2019")),r.a.createElement(R.a,{className:s.paperBody},r.a.createElement(q.a,{className:s.table,"aria-label":"simple table"},r.a.createElement(Q.a,null,r.a.createElement(Y.a,null,r.a.createElement($.a,null,"Series Title (English)"),r.a.createElement($.a,{align:"right"},"Episode"))),!n&&a&&r.a.createElement(Z.a,null,a.series.map((function(e){return r.a.createElement(Y.a,{key:e.seriesTitle},r.a.createElement($.a,{component:"th",scope:"row"},e.seriesTitle),r.a.createElement($.a,{align:"right"},e.episode))})))),n&&r.a.createElement(A.a,{size:60})))},Ae=function(e){var a=e.backendURI,t=Object(n.useReducer)(k,y),s=Object(o.a)(t,2),c=s[0],i=s[1],m=Object(n.useState)(!1),d=Object(o.a)(m,2),u=d[0],g=d[1],p=Object(n.useState)(""),E=Object(o.a)(p,2),f=E[0],h=E[1],S=Object(n.useState)(!1),b=Object(o.a)(S,2),v=b[0],N=b[1],C=Object(n.useState)(""),j=Object(o.a)(C,2),I=j[0],D=j[1];Object(n.useEffect)((function(){!function(){var e,t,n;l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,i(O.fetchSeasonsStart()),r.next=4,l.a.awrap(w.a.get(a+"/getAllSeasons"));case 4:e=r.sent,t=e.data.lastSyncMs,n=t?new Date(t):void 0,i(O.fetchSeasonsSuccess({json:e.data.seasons,lastSync:n})),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),console.log(r.t0);case 13:case"end":return r.stop()}}),null,null,[[0,10]])}()}),[a]),Object(n.useEffect)((function(){!function(){var e,t;l.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,i(O.fetchOnDeckStart()),n.next=4,l.a.awrap(w.a.get(a+"/getOnDeckReports"));case 4:e=n.sent,(t=e.data.reports)&&t.length>0&&i(O.fetchOnDeckSuccess({report:t[0]})),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),console.log(n.t0);case 12:case"end":return n.stop()}}),null,null,[[0,9]])}()}),[a]);var R=function(e,t){var n;return l.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n={sheetId:t.sheetId,startDate:e?e.getTime():null},r.next=3,l.a.awrap(w.a.post(a+"/setSeasonStartDate",n));case 3:200===r.sent.status&&i(O.setSeasonStartDate({season:t,startDate:e}));case 5:case"end":return r.stop()}}))},L=function(e,t,n){var r,s;return l.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return r={seasonId:t,row:e.rowIndex,seriesId:n},c.prev=1,c.next=4,l.a.awrap(w.a.post(a+"/setSeriesId",r));case 4:200===(s=c.sent).status&&(i(O.setSeriesId({series:e,data:s.data.data})),h("Updated AniList ID for ".concat(e.titleRaw)),g(!0)),c.next=12;break;case 8:c.prev=8,c.t0=c.catch(1),D("Error when updating AniList ID for ".concat(e.titleRaw)),N(!0);case 12:case"end":return c.stop()}}),null,null,[[1,8]])};return r.a.createElement("div",{className:"App"},r.a.createElement(pe,null),r.a.createElement("div",{className:"App-body"},r.a.createElement(x.d,null,r.a.createElement(x.b,{exact:!0,path:"/"},r.a.createElement(x.a,{to:"/ondeck"})),r.a.createElement(x.b,{exact:!0,path:"/ondeck"},r.a.createElement(Le,{report:c.ondeck,loading:c.loadingOnDeck})),r.a.createElement(x.b,{exact:!0,path:"/seasons"},r.a.createElement(B,{seasons:c.seasons,lastSyncDate:c.lastSync,loading:c.loadingSeasons,onStartDateChanged:R})),r.a.createElement(x.b,{path:"/s/:seasonId",render:function(e){var t=e.match;return r.a.createElement(se,{dispatch:i,backendURI:a,season:c.seasons.find((function(e){return String(e.sheetId)===t.params.seasonId})),seriesList:c.seriesForSeason,onStartDateChanged:R,onSeriesIdChanged:L})}}))),r.a.createElement((function(){return r.a.createElement("div",{className:"App-footer"},r.a.createElement("a",{href:"https://github.com/brisberg/friday-fellows-gcf"},"Github"))}),null),r.a.createElement(De,{open:u,msg:f,handleClose:g}),r.a.createElement(Ie,{open:v,msg:I,handleClose:N}))};var Te={BACKEND_URI:"https://us-central1-driven-utility-202807.cloudfunctions.net"};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var _e=t(208),Ue=t(96),Fe=Object(Ue.a)({palette:{type:"dark"}});c.a.render(r.a.createElement(_e.a,{theme:Fe},r.a.createElement(_.a,null,r.a.createElement(Ae,{backendURI:Te.BACKEND_URI}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},91:function(e,a,t){e.exports=t.p+"static/media/logo.25bf045c.svg"}},[[114,1,2]]]);
//# sourceMappingURL=main.0f9d7639.chunk.js.map